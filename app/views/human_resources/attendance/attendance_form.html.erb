<%
   # If an attendance is passed; these transfer it to variables; if not, some default values.
   if(@selected_attendance.present?)
     selected_attendance_id = @selected_attendance.id
     selected_attendance_employee_id = @selected_attendance.employee_id
     selected_attendance_timein = @selected_attendance.timein
     selected_attendance_timeout = @selected_attendance.timeout
     selected_attendance_remark = @selected_attendance.remark
   else
     selected_attendance_id = ''
     selected_attendance_employee_id = ''
     selected_attendance_timein = Time.now
     selected_attendance_timeout = Time.now
     selected_attendance_remark = ''
   end
%>

<section class='small-10 columns'>
  <div class='mainheader'> Attendance Form </div>
  <div class='subdescription'> Set the Attendance of an Employee </div>
  <hr>
  <div class='small-6 columns generic_form'>
    <% if @selected_attendance.present? %>
        <span class="current_edit_id"> <%= 'Editing Attendance ID: ' + selected_attendance_id %> </span> <br><br> <!-- this is for the current ATTENDANCE ID or OBJECT ID; not employee-->
    <% end %>
    <%= form_tag( {action: :process_duty_status_form}, multipart: true, class: 'create_form', id: "new_attendance_form", :"data-parsley-validate" => "" ) do %>
        <%= hidden_field_tag('attendance[id]', @selected_attendance_id ) %> <!-- Hidden Field from ID -->
        <select name='attendance[employee_id]'
                id='new_attendance_employee'
                class='employee_select_field'
                required="required" >
          <!-- DO NOT CHANGE class 'employee_select_field'; this is for the employee_quick_profile thing; do change other attributes in the select field -->
          <option value="" disabled selected>Select Employee</option>
          <% @employees.each do |employee| %> <!-- This selects the current employee and marks the option 'selected' if found -->
              <% if(  employee.id == @selected_attendance_employee_id ) %>
                  <option value=<%= employee.id %> selected><%= employee.actor.name %></option>
              <% else %>
                  <option value=<%= employee.id %>><%= employee.actor.name %></option>
              <% end %>
          <% end %>
        </select>
        <!-- input of type datetime-local do not have a placeholder so you have to write the label manually outside the input -->
        <div>Time In: <input type="datetime-local" required="required" name="attendance[timein]" style="width: 50%" value= <%= selected_attendance_timein.strftime('%FT%T') %> ></div> <!-- take note of time format! -->
        <div>Time Out: <input type="datetime-local" required="required" name="attendance[timeout]" style="width: 50%" value= <%= selected_attendance_timeout.strftime('%FT%T') %> ></div> <!-- take note of time format! -->
        <%= text_area_tag("attendance[remark]", content = selected_attendance_remark, options = {class: "remark_description", :"data-parsley-trigger" => "keyup", :"data-parsley-maxlength"=>"128", :placeholder => 'Remarks' }) %>
        <input type="submit" class="small button" value="SUBMIT" />

    <% end %>
  </div>
  <%= renderCorePartial('employee_quick_profile') %>
</section>