<section class='small-10 columns'>
  <%= generic_title('Expenses','Displays all the expenses and their details by all persons within the enterprise') %>
  <%= generic_table_search %>
  <% table_orientation = shift_table_orientation %>
  <% begin %>
      <table class='generic_table' id='expense_table'>
        <thead>
        <tr>
          <%= generic_table_theadlink('ID','expenses.id', table_orientation) %>
          <%= generic_table_theadlink('Amount','expenses.amount', table_orientation) %>
          <%= generic_table_theadlink('Category', 'expenses.category', table_orientation) %>
          <%= generic_table_theadlink('Physical ID', 'expenses.physical_id', table_orientation) %>
          <th>Involved Entities</th>
          <%= generic_table_theadlink('Remark','expenses.remark', table_orientation) %>
          <%= generic_table_theadlink('Date of Effectivity','expenses.date_of_effectivity', table_orientation) %>
          <th class="actions" align="center">&nbsp;</th>
        </tr>
        </thead>
        <% if @expenses.empty? == true %>
            <% raise exception %>
        <% else %>
            <tbody>
            <% @expenses.each do |e| %>
                <tr>
                  <td><%= e[:id].upcase %></td>
                  <td><%= e[:amount] %> </td>
                  <td><%= e[:category] %> </td>
                  <td><%= e[:physical_id] %> </td>
                  <td><%= get_all_entities_involved_with_a_model(ExpensesActor, "expenses_actors.expense_id = ?", e[:id]).collect { |i| i.name }.join(", ")%></td>
                  <td><%= e[:remark] %> </td>
                  <td><%= e[:date_of_effectivity] %> </td>
                  <td class="actions">
                    <%= generic_table_actions(e[:id]) %>
                  </td>
                </tr>
            <% end %>
            </tbody>
        <% end %>
      </table>
  <% rescue => ex %>
      <%= generic_table_error(ex) %>
  <% end %>
  <%= generic_table_footer(@expenses) %>
</section>